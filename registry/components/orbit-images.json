{
  "name": "orbit-images",
  "type": "registry:ui",
  "description": "Displays a set of images in an orbiting motion.",
  "registryDependencies": [
    "utils"
  ],
  "files": [
    {
      "name": "orbit-images.ts",
      "content": "\"use client\";\r\n\r\nimport Image from \"next/image\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nimport { Button } from \"./ui/button\";\r\n\r\ninterface OrbitImagesProps {\r\n  title: string;\r\n  buttonText: string;\r\n  classNameButton?: string;\r\n  outsideBorderColor?: string;\r\n  middleBorderColor?: string;\r\n  innerBorderColor?: string;\r\n  images: string[];\r\n}\r\n\r\nfunction getAngleForIndex(index: number, total: number): number {\r\n  if (total <= 0) return 0;\r\n  return (2 * Math.PI * index) / total;\r\n}\r\n\r\nexport function OrbitImages({\r\n  title,\r\n  buttonText,\r\n  classNameButton,\r\n  images,\r\n  outsideBorderColor,\r\n  middleBorderColor,\r\n  innerBorderColor,\r\n}: OrbitImagesProps) {\r\n  const [animationProgress, setAnimationProgress] = useState(0);\r\n  const [rotationAngle, setRotationAngle] = useState(0);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const rotationRef = useRef<number | null>(null);\r\n\r\n  useEffect(() => {\r\n    const handleScroll = () => {\r\n      if (!containerRef.current) return;\r\n\r\n      const rect = containerRef.current.getBoundingClientRect();\r\n      const windowHeight = window.innerHeight;\r\n\r\n      const start = windowHeight * 0.8;\r\n      const end = windowHeight * 0.2;\r\n\r\n      const rawProgress = (start - rect.top) / (start - end);\r\n      const progress = Math.max(0, Math.min(1, rawProgress));\r\n\r\n      setAnimationProgress(progress);\r\n    };\r\n\r\n    let ticking = false;\r\n    const throttledScroll = () => {\r\n      if (!ticking) {\r\n        requestAnimationFrame(() => {\r\n          handleScroll();\r\n          ticking = false;\r\n        });\r\n        ticking = true;\r\n      }\r\n    };\r\n\r\n    handleScroll();\r\n\r\n    window.addEventListener(\"scroll\", throttledScroll, { passive: true });\r\n    window.addEventListener(\"resize\", handleScroll, { passive: true });\r\n\r\n    return () => {\r\n      window.removeEventListener(\"scroll\", throttledScroll);\r\n      window.removeEventListener(\"resize\", handleScroll);\r\n    };\r\n  }, []);\r\n\r\n  const shouldStartRotation = animationProgress >= 1;\r\n\r\n  useEffect(() => {\r\n    if (shouldStartRotation) {\r\n      const startRotation = () => {\r\n        setRotationAngle((prev) => prev + 0.1);\r\n        rotationRef.current = requestAnimationFrame(startRotation);\r\n      };\r\n      rotationRef.current = requestAnimationFrame(startRotation);\r\n    } else {\r\n      if (rotationRef.current) {\r\n        cancelAnimationFrame(rotationRef.current);\r\n        rotationRef.current = null;\r\n      }\r\n      setRotationAngle(0);\r\n    }\r\n\r\n    return () => {\r\n      if (rotationRef.current) {\r\n        cancelAnimationFrame(rotationRef.current);\r\n        rotationRef.current = null;\r\n      }\r\n    };\r\n  }, [shouldStartRotation]);\r\n\r\n  // âœ… 1. RAIO RESPONSIVO\r\n  const getResponsiveRadius = () => {\r\n    if (typeof window === \"undefined\") return 300;\r\n    if (window.innerWidth < 640) return 150; // Mobile\r\n    if (window.innerWidth < 1024) return 300; // Tablet\r\n    if (window.innerWidth < 1440) return 270; // Laptop\r\n    return 300; // Desktop\r\n  };\r\n  const expandRadius = animationProgress * getResponsiveRadius();\r\n\r\n  const getImagePosition = (baseAngle: number) => {\r\n    const totalAngle = baseAngle + (rotationAngle * Math.PI) / 180;\r\n    return {\r\n      x: expandRadius * Math.cos(totalAngle),\r\n      y: expandRadius * Math.sin(totalAngle),\r\n    };\r\n  };\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      className=\"h-full px-4 sm:px-6 md:min-h-[100vh] lg:px-8\"\r\n    >\r\n      <div className=\"sticky top-0 flex h-screen items-center justify-center p-2 sm:p-4 lg:p-8\">\r\n        <div className=\"relative\">\r\n          <div\r\n            className={cn(\r\n              `flex h-[280px] w-[280px] items-center justify-center rounded-full transition-all duration-500 sm:h-[600px] sm:w-[600px] lg:h-[500px] lg:w-[500px] xl:h-[600px] xl:w-[600px]`,\r\n              animationProgress > 0.6 && \"border-pittaya/60 border-2\",\r\n              outsideBorderColor\r\n            )}\r\n          >\r\n            <div\r\n              className={cn(\r\n                `relative flex h-[240px] w-[240px] items-center justify-center rounded-full transition-all duration-500 sm:h-[480px] sm:w-[480px] lg:h-[420px] lg:w-[420px] xl:h-[500px] xl:w-[500px]`,\r\n                animationProgress > 0.2 && \"border-pittaya/80 border-2\",\r\n                middleBorderColor\r\n              )}\r\n            >\r\n              <div\r\n                className={cn(\r\n                  \"border-pittaya relative flex h-[200px] w-[200px] items-center justify-center rounded-full border-2 p-0.5 sm:h-[400px] sm:w-[400px] lg:h-[340px] lg:w-[340px] xl:h-[400px] xl:w-[400px]\",\r\n                  innerBorderColor\r\n                )}\r\n              >\r\n                <div className=\"relative flex h-full w-full items-center justify-center rounded-full bg-[#ffffff] dark:bg-black\">\r\n                  {images.map((imageSrc, index) => {\r\n                    const baseAngle = getAngleForIndex(index, images.length);\r\n                    const position = getImagePosition(baseAngle);\r\n\r\n                    return (\r\n                      <div\r\n                        key={`${imageSrc}-${index}`}\r\n                        className=\"absolute z-0 h-16 w-16 overflow-hidden rounded-xl border-2 border-white shadow-lg sm:rounded-2xl sm:border-4 md:h-26 md:w-26 lg:h-24 lg:w-24 dark:border-gray-800\"\r\n                        style={{\r\n                          transform: `translate3d(${position.x}px, ${position.y}px, 0)`,\r\n                          willChange: \"transform\",\r\n                        }}\r\n                      >\r\n                        <Image\r\n                          src={imageSrc}\r\n                          alt={`Profile ${index + 1}`}\r\n                          className=\"h-full w-full object-cover\"\r\n                          width={200}\r\n                          height={200}\r\n                        />\r\n                      </div>\r\n                    );\r\n                  })}\r\n\r\n                  <div\r\n                    className=\"relative z-20 flex max-w-[160px] flex-col items-center justify-center gap-6 px-2 text-center transition-opacity duration-500 sm:max-w-[300px] sm:px-4 lg:max-w-xs\"\r\n                    style={{\r\n                      opacity:\r\n                        animationProgress > 0.5\r\n                          ? (animationProgress - 0.5) * 2\r\n                          : 0,\r\n                    }}\r\n                  >\r\n                    <p className=\"text-center text-xs leading-tight text-gray-500 sm:leading-normal md:text-lg lg:text-base dark:text-gray-400\">\r\n                      {title}\r\n                    </p>\r\n\r\n                    <Button\r\n                      variant={\"default\"}\r\n                      className={cn(\r\n                        \"bg-pittaya shadow-pittaya/20 hover:bg-pittaya/80 rounded-full text-white shadow-lg\",\r\n                        classNameButton\r\n                      )}\r\n                    >\r\n                      {buttonText}\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"
    }
  ]
}