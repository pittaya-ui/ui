{
  "name": "orbit-images",
  "type": "registry:ui",
  "description": "Displays a set of images in an orbiting motion.",
  "registryDependencies": [
    "button",
    "utils"
  ],
  "files": [
    {
      "name": "orbit-images.tsx",
      "content": "\"use client\";\n\nimport Image from \"next/image\";\nimport { useEffect, useRef, useState } from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\nimport { Button } from \"./button\";\n\n\ninterface OrbitImagesProps {\n  title: string;\n  buttonText: string;\n  classNameButton?: string;\n  outsideBorderColor?: string;\n  middleBorderColor?: string;\n  innerBorderColor?: string;\n  images: string[];\n  autoPlay?: boolean;\n}\n\nfunction getAngleForIndex(index: number, total: number): number {\n  if (total <= 0) return 0;\n  return (2 * Math.PI * index) / total;\n}\n\nexport function OrbitImages({\n  title,\n  buttonText,\n  classNameButton,\n  images,\n  outsideBorderColor = \"border-rose-400/60\",\n  middleBorderColor = \"border-rose-400/80\",\n  innerBorderColor = \"border-rose-400\",\n  autoPlay = false,\n}: OrbitImagesProps) {\n  const [animationProgress, setAnimationProgress] = useState(autoPlay ? 1 : 0);\n  const [rotationAngle, setRotationAngle] = useState(0);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const rotationRef = useRef<number | null>(null);\n\n  useEffect(() => {\n    if (autoPlay) return;\n\n    const handleScroll = () => {\n      if (!containerRef.current) return;\n\n      const rect = containerRef.current.getBoundingClientRect();\n      const windowHeight = window.innerHeight;\n\n      const start = windowHeight * 0.8;\n      const end = windowHeight * 0.2;\n\n      const rawProgress = (start - rect.top) / (start - end);\n      const progress = Math.max(0, Math.min(1, rawProgress));\n\n      setAnimationProgress(progress);\n    };\n\n    let ticking = false;\n    const throttledScroll = () => {\n      if (!ticking) {\n        requestAnimationFrame(() => {\n          handleScroll();\n          ticking = false;\n        });\n        ticking = true;\n      }\n    };\n\n    handleScroll();\n\n    window.addEventListener(\"scroll\", throttledScroll, { passive: true });\n    window.addEventListener(\"resize\", handleScroll, { passive: true });\n\n    return () => {\n      window.removeEventListener(\"scroll\", throttledScroll);\n      window.removeEventListener(\"resize\", handleScroll);\n    };\n  }, [autoPlay]);\n\n  const shouldStartRotation = animationProgress >= 1;\n\n  useEffect(() => {\n    if (shouldStartRotation) {\n      const startRotation = () => {\n        setRotationAngle((prev) => prev + 0.1);\n        rotationRef.current = requestAnimationFrame(startRotation);\n      };\n      rotationRef.current = requestAnimationFrame(startRotation);\n    } else {\n      if (rotationRef.current) {\n        cancelAnimationFrame(rotationRef.current);\n        rotationRef.current = null;\n      }\n      setRotationAngle(0);\n    }\n\n    return () => {\n      if (rotationRef.current) {\n        cancelAnimationFrame(rotationRef.current);\n        rotationRef.current = null;\n      }\n    };\n  }, [shouldStartRotation]);\n\n  // âœ… 1. RAIO RESPONSIVO\n  const getResponsiveRadius = () => {\n    if (typeof window === \"undefined\") return 300;\n    if (window.innerWidth < 640) return 150; // Mobile\n    if (window.innerWidth < 1024) return 300; // Tablet\n    if (window.innerWidth < 1440) return 270; // Laptop\n    return 300; // Desktop\n  };\n  const expandRadius = animationProgress * getResponsiveRadius();\n\n  const getImagePosition = (baseAngle: number) => {\n    const totalAngle = baseAngle + (rotationAngle * Math.PI) / 180;\n    return {\n      x: expandRadius * Math.cos(totalAngle),\n      y: expandRadius * Math.sin(totalAngle),\n    };\n  };\n\n  return (\n    <div\n      ref={containerRef}\n      className=\"h-full px-4 sm:px-6 md:min-h-[100vh] lg:px-8\"\n    >\n      <div className=\"sticky top-0 flex h-screen items-center justify-center p-2 sm:p-4 lg:p-8\">\n        <div className=\"relative\">\n          <div\n            className={cn(\n              `flex h-[280px] w-[280px] items-center justify-center rounded-full border-2 transition-all duration-500 sm:h-[600px] sm:w-[600px] lg:h-[500px] lg:w-[500px] xl:h-[600px] xl:w-[600px]`,\n              animationProgress > 0.6 && outsideBorderColor\n            )}\n          >\n            <div\n              className={cn(\n                `relative flex h-[240px] w-[240px] items-center justify-center rounded-full border-2 transition-all duration-500 sm:h-[480px] sm:w-[480px] lg:h-[420px] lg:w-[420px] xl:h-[500px] xl:w-[500px]`,\n                animationProgress > 0.2 && middleBorderColor\n              )}\n            >\n              <div\n                className={cn(\n                  \"relative flex h-[200px] w-[200px] items-center justify-center rounded-full border-2 p-0.5 sm:h-[400px] sm:w-[400px] lg:h-[340px] lg:w-[340px] xl:h-[400px] xl:w-[400px]\",\n                  innerBorderColor\n                )}\n              >\n                <div className=\"relative flex h-full w-full items-center justify-center rounded-full bg-[#ffffff] dark:bg-black\">\n                  {images.map((imageSrc, index) => {\n                    const baseAngle = getAngleForIndex(index, images.length);\n                    const position = getImagePosition(baseAngle);\n\n                    return (\n                      <div\n                        key={`${imageSrc}-${index}`}\n                        className=\"absolute z-0 h-16 w-16 overflow-hidden rounded-xl border-2 border-white shadow-lg sm:rounded-2xl sm:border-4 md:h-26 md:w-26 lg:h-24 lg:w-24 dark:border-gray-800\"\n                        style={{\n                          transform: `translate3d(${position.x}px, ${position.y}px, 0)`,\n                          willChange: \"transform\",\n                        }}\n                      >\n                        <Image\n                          src={imageSrc}\n                          alt={`Profile ${index + 1}`}\n                          className=\"h-full w-full object-cover\"\n                          width={200}\n                          height={200}\n                        />\n                      </div>\n                    );\n                  })}\n\n                  <div\n                    className=\"relative z-20 flex max-w-[160px] flex-col items-center justify-center gap-6 px-2 text-center transition-opacity duration-500 sm:max-w-[300px] sm:px-4 lg:max-w-xs\"\n                    style={{\n                      opacity:\n                        animationProgress > 0.5\n                          ? (animationProgress - 0.5) * 2\n                          : 0,\n                    }}\n                  >\n                    <p className=\"text-center text-xs leading-tight text-gray-500 sm:leading-normal md:text-lg lg:text-base dark:text-gray-400\">\n                      {title}\n                    </p>\n\n                    <Button\n                      variant={\"default\"}\n                      className={cn(\n                        \"bg-pittaya shadow-pittaya/20 hover:bg-pittaya/80 rounded-full text-white shadow-lg\",\n                        classNameButton\n                      )}\n                    >\n                      {buttonText}\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"
    }
  ]
}